# 性能瓶颈排查思维导图

好的，我将把上面的全景思维导图拆分成一个总览图和六个详细的分支图。这样结构更清晰，也便于您分部分查看和理解。

### 1. 总览图 (性能瓶颈定位主要方向)

这个图展示了性能瓶颈定位的六个核心方向。

```mermaid
flowchart TD
    P[性能瓶颈定位思路]

    P --> I[接口响应慢]
    P --> T[TPS问题]
    P --> E[错误率高]
    P --> R[资源指标异常]
    P --> S[复杂系统瓶颈]
    P --> O[其他补充定位点]
```

---

### 2. 分图一：接口响应慢

```mermaid
flowchart LR
    I[接口响应慢]

    I --> I1[数据库交互]
    I --> I2[Redis交互]
    I --> I3[消息队列]
    I --> I4[业务方法]
    I --> I5[外部依赖与网络]
    I --> I6[Web服务器]

    I1 --> I1_1[慢SQL/缺失索引]
    I1 --> I1_2[锁竞争/事务过长]
    I1 --> I1_3[连接池过小]
    I1 --> I1_4[查询优化器选错执行计划]
    I1 --> I1_5[数据库死锁]

    I2 --> I2_1[慢查询/大Key]
    I2 --> I2_2[频繁访问]
    I2 --> I2_3[连接池限制]
    I2 --> I2_4[缓存穿透/雪崩]
    I2 --> I2_5[序列化/反序列化成本高]

    I3 --> I3_1[生产者发送慢]
    I3 --> I3_2[Broker积压]
    I3 --> I3_3[消费者消费能力不足]

    I4 --> I4_1[线程阻塞/竞争]
    I4 --> I4_2[跨线程同步]
    I4 --> I4_3[正则表达式]
    I4 --> I4_4[锁粒度不合理]
    I4 --> I4_5[算法复杂度高]

    I5 --> I5_1[第三方API响应慢]
    I5 --> I5_2[网络延迟/丢包]
    I5 --> I5_3[DNS查询慢]

    I6 --> I6_1[Tomcat等Web容器线程池满]
    I6 --> I6_2[Nginx负载均衡策略或配置问题]
```

---

### 3. 分图二：TPS问题

```mermaid
flowchart LR
    T[TPS问题]

    T --> T1[资源消耗不高 TPS无法提升]
    T --> T2[TPS逐渐降低]
    T --> T3[响应时间/TPS尖刺]

    T1 --> T1_1[线程阻塞/线程池耗尽]
    T1 --> T1_2[外部系统限流]
    T1 --> T1_3[应用内部限流]

    T2 --> T2_1[内存泄漏]
    T2 --> T2_2[表数据量变大]
    T2 --> T2_3[磁盘满]
    T2 --> T2_4[数据库连接泄漏]

    T3 --> T3_1[缓存击穿]
    T3 --> T3_2[GC停顿]
    T3 --> T3_3[定时任务启动]
    T3 --> T3_4[宿主机其他进程资源争用]
```

---

### 4. 分图三：错误率高

```mermaid
flowchart LR
    E[错误率高]

    E --> E1[限流报错]
    E --> E2[代码异常]
    E --> E3[网络/连接异常]
    E --> E4[端口不足]
    E --> E5[依赖服务宕机]
    E --> E6[数据一致性冲突 如唯一键冲突]
    E --> E7[认证/授权失败]
```

---

### 5. 分图四：资源指标异常

```mermaid
flowchart LR
    R[资源指标异常]

    R --> R1[CPU利用率高]
    R --> R2[内存异常]
    R --> R3[磁盘IO高]
    R --> R4[网络IO高]

    R1 --> R1_1[死循环/爬栈]
    R1 --> R1_2[频繁异常]
    R1 --> R1_3[正则操作]
    R1 --> R1_4[加密解密]
    R1 --> R1_5[频繁GC]
    R1 --> R1_6[序列化/反序列化]

    R2 --> R2_1[内存增长快]
    R2 --> R2_2[内存泄漏]
    R2 --> R2_3[JVM堆大小配置不合理]

    R3 --> R3_1[写业务日志]
    R3 --> R3_2[读写业务文件]
    R3 --> R3_3[SWAP频繁交换]
    R3 --> R3_4[数据库临时表操作]

    R4 --> R4_1[带宽限制]
    R4 --> R4_2[网卡积压]
    R4 --> R4_3[网络包大小/频繁传输大对象]
```

---

### 6. 分图五：复杂系统瓶颈

```mermaid
flowchart LR
    S[复杂系统瓶颈]

    S --> S1[分析响应时间增长斜率]
    S --> S2[梳理慢接口链路拓扑找交集]
    S --> S3[检查负载均衡策略]
    S --> S4[使用链路追踪Pinpoint/Skywalking]
    S --> S5[服务耦合度高, 单点瓶颈拖垮整体]
```

---

### 7. 分图六：其他补充定位点

```mermaid
flowchart LR
    O[其他补充定位点]

    O --> O1[JVM问题 JVM参数配置不当 如堆大小, GC算法选择]
    O --> O2[操作系统级别 文件句柄数限制 系统线程数限制]
    O --> O3[中间件配置 MQ堆积告警 ES分片设置不合理/深度分页]
    O --> O4[容器化环境 容器资源限额Cgroup 镜像拉取慢]
    O --> O5[监控与工具 APM工具Arthas 建立性能基线]
    O --> O6[日志问题 同步日志阻塞业务线程 日志级别过高输出过多]
```

希望这7张分图能帮助您更清晰、更有针对性地进行性能瓶颈定位！每个分图都可以独立使用，专注于解决某一类特定的性能问题。