(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{471:function(t,a,i){"use strict";i.r(a);var e=i(2),v=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"app启动性能分析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#app启动性能分析"}},[t._v("#")]),t._v(" App启动性能分析")]),t._v(" "),a("h2",{attrs:{id:"启动性能分析执行"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#启动性能分析执行"}},[t._v("#")]),t._v(" 启动性能分析执行")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("目的")]),t._v(" "),a("th",[t._v("命令")]),t._v(" "),a("th",[t._v("期望")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[t._v("指定App的包名")]),t._v(" "),a("td",[t._v("package=com.xueqiu.android")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("清楚缓存")]),t._v(" "),a("td",[t._v("adb shell pm clear $package")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("强制停止App")]),t._v(" "),a("td",[t._v("adb shell am force-stop $package")]),t._v(" "),a("td")]),t._v(" "),a("tr",[a("td",[t._v("启动App")]),t._v(" "),a("td",[t._v("adb shell am start -S -W $package/.view.WelcomeActivityAlias")]),t._v(" "),a("td",[t._v("Stopping: com.xueqiu.android"),a("br"),t._v("Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.xueqiu.android/.view.WelcomeActivityAlias }"),a("br"),t._v("Status: ok"),a("br"),t._v("Activity: com.xueqiu.android/.view.WelcomeActivityAlias"),a("br"),t._v("ThisTime: 1317"),a("br"),t._v("TotalTime: 1317"),a("br"),t._v("WaitTime: 1322"),a("br"),t._v("Complete")])]),t._v(" "),a("tr",[a("td",[t._v("调用logcat查看启动过程信息获取数据")]),t._v(" "),a("td",[t._v("adb logcat | grep -i displayed")]),t._v(" "),a("td",[t._v("04-09 12:42:20.374   731   752 I ActivityManager: Displayed com.mumu.launcher/.Launcher: +952ms"),a("br"),t._v("04-09 13:18:59.143   731   752 I ActivityManager: Displayed com.xueqiu.android/.view.WelcomeActivityAlias: +1s317ms"),a("br"),t._v("04-09 13:19:01.032   731   752 I ActivityManager: Displayed com.xueqiu.android/.common.MainActivity: +573ms"),a("br"),t._v("04-09 13:19:05.566   731   752 I ActivityManager: Displayed com.xueqiu.android/.common.UpdateDialogActivity: +32ms")])])])]),t._v(" "),a("p",[t._v("一个App由多个Activity组成")]),t._v(" "),a("p",[t._v("waittime由系统运行快慢决定")]),t._v(" "),a("p",[t._v("StartTime: 记录刚准备调用startActivityAndWait()的时间点")]),t._v(" "),a("p",[t._v("endTime: 记录startActivityAndWait()函数调用返回的时间点")]),t._v(" "),a("p",[t._v("WaitTime: startActivityAndWait()调用耗时")]),t._v(" "),a("p",[t._v("WaitTime = endTime - startTime")]),t._v(" "),a("h2",{attrs:{id:"使用ffmpeg拆帧"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用ffmpeg拆帧"}},[t._v("#")]),t._v(" 使用ffmpeg拆帧")]),t._v(" "),a("p",[t._v("package=com.xueqiu.android")]),t._v(" "),a("p",[t._v("adb shell am force-stop $package")]),t._v(" "),a("p",[t._v("adb shell screenrecord --bugreport --time-limit 30 /data/local/tmp/xueqiu.MP4 &")]),t._v(" "),a("p",[t._v("adb shell am start -S -W $package/.view.WelcomeActivityAlias")]),t._v(" "),a("p",[t._v("wait")]),t._v(" "),a("p",[t._v("adb pull /data/local/tmp/xueqiu.mp4")]),t._v(" "),a("p",[t._v("ffmpeg -i xueqiu.mp4 xueqiu.gif")]),t._v(" "),a("p",[t._v("ffmpeg -i xueqiu.mp4 -r 10 frames_%03d.jpg")]),t._v(" "),a("h3",{attrs:{id:"windows端的命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#windows端的命令"}},[t._v("#")]),t._v(" Windows端的命令")]),t._v(" "),a("p",[t._v("adb shell am force-stop com.xueqiu.android    ##  停止App")]),t._v(" "),a("p",[t._v("adb shell screenrecord --bugreport --time-limit 30 /data/local/tmp/xueqiu.mp4 & (window端不用加&)   ## 使用命令录制视频")]),t._v(" "),a("p",[t._v("adb shell am start -S -W com.xueqiu.android/.view.WelcomeActivityAlias   # 使用命令来启动App,实际上要切换另外一个控制台,因为当前控制台在录制")]),t._v(" "),a("p",[t._v("wait")]),t._v(" "),a("p",[t._v("adb pull /data/local/tmp/xueqiu.mp4      ##该命令从模拟器中拉取录制的视频")]),t._v(" "),a("p",[t._v("ffmpeg -i xueqiu.mp4 xueqiu.gif    ##该命令将mp4转换成gif动图")]),t._v(" "),a("p",[t._v("ffmpeg -i xueqiu.mp4 -r 10 frames_%03d.jpg    ##该命令将mp4转换成jpg图")])])}),[],!1,null,null,null);a.default=v.exports}}]);