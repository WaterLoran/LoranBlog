(window.webpackJsonp=window.webpackJsonp||[]).push([[168],{596:function(s,a,t){"use strict";t.r(a);var _=t(2),e=Object(_.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("MySQL 8 中的索引问题可能会导致查询性能下降、锁争用增多或资源使用率高。因此，排查和优化数据库索引是提高查询性能的重要手段。以下是如何在 MySQL 8 中排查索引问题的详细步骤。")]),s._v(" "),a("h3",{attrs:{id:"_1-检查表结构和索引使用情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-检查表结构和索引使用情况"}},[s._v("#")]),s._v(" 1. "),a("strong",[s._v("检查表结构和索引使用情况")])]),s._v(" "),a("p",[s._v("首先，你需要确认表上是否已经存在索引，以及哪些列已经建立了索引。你可以使用 "),a("code",[s._v("SHOW INDEX")]),s._v(" 命令来查看表中的索引。")]),s._v(" "),a("h4",{attrs:{id:"查看表上的索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看表上的索引"}},[s._v("#")]),s._v(" 查看表上的索引")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[a("strong",[s._v("Key_name")]),s._v("：索引的名称。")]),s._v(" "),a("li",[a("strong",[s._v("Seq_in_index")]),s._v("：索引中列的位置（用于复合索引）。")]),s._v(" "),a("li",[a("strong",[s._v("Column_name")]),s._v("：索引使用的列。")]),s._v(" "),a("li",[a("strong",[s._v("Cardinality")]),s._v("：索引的基数，表示索引中唯一值的数量。基数越高，查询效率越好。")])]),s._v(" "),a("p",[s._v("通过查看这些信息，你可以了解当前表中是否有适当的索引，哪些列已经被索引。")]),s._v(" "),a("h3",{attrs:{id:"_2-使用-explain-分析查询"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-使用-explain-分析查询"}},[s._v("#")]),s._v(" 2. "),a("strong",[s._v("使用 "),a("code",[s._v("EXPLAIN")]),s._v(" 分析查询")])]),s._v(" "),a("p",[a("code",[s._v("EXPLAIN")]),s._v(" 是 MySQL 提供的工具，用来查看查询的执行计划。它可以告诉你查询是否在使用索引，是否存在全表扫描等问题。")]),s._v(" "),a("h4",{attrs:{id:"使用-explain-语句"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-explain-语句"}},[s._v("#")]),s._v(" 使用 "),a("code",[s._v("EXPLAIN")]),s._v(" 语句")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPLAIN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h4",{attrs:{id:"explain-输出字段解读"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#explain-输出字段解读"}},[s._v("#")]),s._v(" "),a("code",[s._v("EXPLAIN")]),s._v(" 输出字段解读")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("id")]),s._v("：查询的执行顺序标识。")]),s._v(" "),a("li",[a("strong",[s._v("select_type")]),s._v("：查询的类型，如 "),a("code",[s._v("SIMPLE")]),s._v("、"),a("code",[s._v("SUBQUERY")]),s._v("。")]),s._v(" "),a("li",[a("strong",[s._v("table")]),s._v("：查询操作的表名。")]),s._v(" "),a("li",[a("strong",[s._v("type")]),s._v("：表示查询类型，越精确的类型越好。常见的类型包括：\n"),a("ul",[a("li",[a("strong",[s._v("ALL")]),s._v("：全表扫描，性能最差。")]),s._v(" "),a("li",[a("strong",[s._v("index")]),s._v("：全索引扫描，性能较差。")]),s._v(" "),a("li",[a("strong",[s._v("range")]),s._v("：使用索引范围扫描，性能较好。")]),s._v(" "),a("li",[a("strong",[s._v("ref")]),s._v("：使用非唯一索引查找行。")]),s._v(" "),a("li",[a("strong",[s._v("const")]),s._v("：精确查找单行，性能最好。")])])]),s._v(" "),a("li",[a("strong",[s._v("possible_keys")]),s._v("：查询中可能使用的索引。")]),s._v(" "),a("li",[a("strong",[s._v("key")]),s._v("：查询实际使用的索引。")]),s._v(" "),a("li",[a("strong",[s._v("rows")]),s._v("：MySQL 预计扫描的行数。")]),s._v(" "),a("li",[a("strong",[s._v("Extra")]),s._v("：额外信息，如 "),a("code",[s._v("Using index")]),s._v("（索引覆盖）或 "),a("code",[s._v("Using filesort")]),s._v("（文件排序）。")])]),s._v(" "),a("h4",{attrs:{id:"示例输出"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例输出"}},[s._v("#")]),s._v(" 示例输出")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("EXPLAIN")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" employees "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" last_name "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Smith'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("输出示例：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("+----+-------------+-----------+------+-----------------+------------+---------+-------+------+-------------+\n| id | select_type | table     | type | possible_keys   | key        | key_len | ref   | rows | Extra       |\n+----+-------------+-----------+------+-----------------+------------+---------+-------+------+-------------+\n|  1 | SIMPLE      | employees | ref  | idx_last_name   | idx_last_name | 768   | const | 1    | Using index |\n+----+-------------+-----------+------+-----------------+------------+---------+-------+------+-------------+\n")])])]),a("p",[s._v("从结果可以看出：")]),s._v(" "),a("ul",[a("li",[s._v("查询使用了 "),a("code",[s._v("idx_last_name")]),s._v(" 索引（"),a("code",[s._v("key")]),s._v(" 列）。")]),s._v(" "),a("li",[s._v("使用 "),a("code",[s._v("ref")]),s._v(" 查找类型，说明该查询通过索引查找记录，而不是全表扫描。")])]),s._v(" "),a("p",[s._v("如果 "),a("code",[s._v("type")]),s._v(" 是 "),a("code",[s._v("ALL")]),s._v("，说明查询进行了全表扫描，这可能会导致性能问题。")]),s._v(" "),a("h3",{attrs:{id:"_3-识别和修复常见的索引问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-识别和修复常见的索引问题"}},[s._v("#")]),s._v(" 3. "),a("strong",[s._v("识别和修复常见的索引问题")])]),s._v(" "),a("h4",{attrs:{id:"_3-1-缺少索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-缺少索引"}},[s._v("#")]),s._v(" 3.1 "),a("strong",[s._v("缺少索引")])]),s._v(" "),a("p",[s._v("如果查询中的 "),a("code",[s._v("WHERE")]),s._v("、"),a("code",[s._v("JOIN")]),s._v(" 或 "),a("code",[s._v("ORDER BY")]),s._v(" 子句中的列没有建立索引，MySQL 可能会进行全表扫描或索引范围扫描，导致查询性能下降。你可以根据查询的需求，为这些列添加索引。")]),s._v(" "),a("h5",{attrs:{id:"添加单列索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加单列索引"}},[s._v("#")]),s._v(" 添加单列索引")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_column_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h4",{attrs:{id:"_3-2-复合索引不正确"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-复合索引不正确"}},[s._v("#")]),s._v(" 3.2 "),a("strong",[s._v("复合索引不正确")])]),s._v(" "),a("p",[s._v("如果查询涉及多个条件，使用复合索引可以大大提高查询效率。复合索引的列顺序非常重要。应该将选择性较高的列放在前面，确保索引能高效地被使用。")]),s._v(" "),a("h5",{attrs:{id:"添加复合索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加复合索引"}},[s._v("#")]),s._v(" 添加复合索引")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CREATE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_multiple_columns "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("column1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" column2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[a("strong",[s._v("例子")]),s._v("：如果查询是 "),a("code",[s._v("WHERE column1 = ? AND column2 = ?")]),s._v("，创建复合索引 "),a("code",[s._v("(column1, column2)")]),s._v(" 会比单独为每个列创建索引更高效。")])]),s._v(" "),a("h4",{attrs:{id:"_3-3-低选择性的索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-低选择性的索引"}},[s._v("#")]),s._v(" 3.3 "),a("strong",[s._v("低选择性的索引")])]),s._v(" "),a("p",[s._v("如果索引列的选择性（唯一值的数量）较低，MySQL 可能不会使用该索引。可以通过查询索引的基数（"),a("code",[s._v("Cardinality")]),s._v("）来评估选择性：")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SHOW")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("你可以通过查看 "),a("code",[s._v("Cardinality")]),s._v(" 列来评估索引的选择性。如果基数较低，说明该列的重复值较多，索引的效果不理想。")]),s._v(" "),a("h4",{attrs:{id:"_3-4-冗余索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-冗余索引"}},[s._v("#")]),s._v(" 3.4 "),a("strong",[s._v("冗余索引")])]),s._v(" "),a("p",[s._v("多个列的索引可能会冗余。例如，存在一个复合索引 "),a("code",[s._v("(column1, column2)")]),s._v(" 时，不需要再为 "),a("code",[s._v("column1")]),s._v(" 创建单独的索引。冗余索引会增加数据库的维护成本，可以通过 "),a("code",[s._v("SHOW INDEX")]),s._v(" 查找不必要的索引，并将其删除。")]),s._v(" "),a("h5",{attrs:{id:"删除冗余索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除冗余索引"}},[s._v("#")]),s._v(" 删除冗余索引")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DROP")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" idx_column_name "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ON")]),s._v(" your_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("h3",{attrs:{id:"_4-利用-analyze-table-优化索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-利用-analyze-table-优化索引"}},[s._v("#")]),s._v(" 4. "),a("strong",[s._v("利用 "),a("code",[s._v("ANALYZE TABLE")]),s._v(" 优化索引")])]),s._v(" "),a("p",[a("code",[s._v("ANALYZE TABLE")]),s._v(" 命令可以帮助你收集表和索引的统计信息，让 MySQL 优化器更好地选择执行计划。特别是在插入或更新大量数据后，索引统计信息可能会变得不准确，使用 "),a("code",[s._v("ANALYZE TABLE")]),s._v(" 可以重新计算这些统计信息。")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ANALYZE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" your_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[s._v("这个命令会更新表的索引统计信息，帮助优化器在执行查询时做出更好的索引选择。")])]),s._v(" "),a("h3",{attrs:{id:"_5-索引碎片清理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-索引碎片清理"}},[s._v("#")]),s._v(" 5. "),a("strong",[s._v("索引碎片清理")])]),s._v(" "),a("p",[s._v("在频繁进行 "),a("code",[s._v("INSERT")]),s._v("、"),a("code",[s._v("UPDATE")]),s._v(" 或 "),a("code",[s._v("DELETE")]),s._v(" 操作的表中，索引可能会变得分散或产生碎片，导致查询效率下降。使用 "),a("code",[s._v("OPTIMIZE TABLE")]),s._v(" 可以减少碎片、重新组织表和索引数据，从而提高性能。")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("OPTIMIZE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("TABLE")]),s._v(" your_table"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("这会对表进行碎片整理，重新组织存储结构。")]),s._v(" "),a("h3",{attrs:{id:"_6-查询优化器提示"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-查询优化器提示"}},[s._v("#")]),s._v(" 6. "),a("strong",[s._v("查询优化器提示")])]),s._v(" "),a("p",[s._v("MySQL 8 中可以使用优化器提示（Optimizer Hints）来强制查询使用特定的索引，或者控制查询计划。优化器提示可以用于测试查询的性能，确保它们使用了正确的索引。")]),s._v(" "),a("h4",{attrs:{id:"强制使用特定索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#强制使用特定索引"}},[s._v("#")]),s._v(" 强制使用特定索引")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" your_table "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("USE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("INDEX")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("idx_column_name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("column")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'value'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("ul",[a("li",[a("strong",[s._v("USE INDEX")]),s._v("：强制查询使用特定的索引。")]),s._v(" "),a("li",[a("strong",[s._v("IGNORE INDEX")]),s._v("：忽略某个索引，强制查询不使用指定索引。")])]),s._v(" "),a("p",[s._v("优化器提示可以帮助你测试不同的索引选择，并选择最合适的索引执行查询。")]),s._v(" "),a("h3",{attrs:{id:"_7-监控索引使用情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-监控索引使用情况"}},[s._v("#")]),s._v(" 7. "),a("strong",[s._v("监控索引使用情况")])]),s._v(" "),a("p",[s._v("MySQL 8 中的 "),a("code",[s._v("performance_schema")]),s._v(" 提供了一些表来帮助你监控查询的索引使用情况，例如 "),a("code",[s._v("events_statements_summary_by_digest")]),s._v(" 表。你可以使用这些表来查看哪些查询没有使用索引，哪些查询频繁出现等。")]),s._v(" "),a("h4",{attrs:{id:"查看查询使用的索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看查询使用的索引"}},[s._v("#")]),s._v(" 查看查询使用的索引")]),s._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("SELECT")]),s._v("\n    DIGEST_TEXT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    COUNT_STAR "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" exec_count"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    SUM_TIMER_WAIT"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000000000000")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("AS")]),s._v(" total_exec_time_sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    INDEX_NAME\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v("\n    performance_schema"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("events_statements_summary_by_digest\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WHERE")]),s._v("\n    INDEX_NAME "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("IS")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("NOT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("NULL")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("ORDER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("BY")]),s._v("\n    total_exec_time_sec "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("DESC")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("LIMIT")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("这会显示执行时间最长的查询和使用的索引。如果某些查询没有使用索引，可以检查是否应该为这些查询添加索引。")]),s._v(" "),a("h3",{attrs:{id:"_8-定期监控和优化索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-定期监控和优化索引"}},[s._v("#")]),s._v(" 8. "),a("strong",[s._v("定期监控和优化索引")])]),s._v(" "),a("p",[s._v("通过使用监控工具（如 "),a("strong",[s._v("Prometheus")]),s._v("、"),a("strong",[s._v("Grafana")]),s._v("）以及 MySQL 内置的 "),a("code",[s._v("performance_schema")]),s._v("，你可以定期监控索引的使用情况和查询性能。定期清理索引碎片、优化查询结构和索引配置，确保数据库的高效运行。")]),s._v(" "),a("h3",{attrs:{id:"总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),a("ol",[a("li",[a("strong",[s._v("检查表结构和索引")]),s._v("：通过 "),a("code",[s._v("SHOW INDEX")]),s._v(" 查看表中的索引，确定是否缺少关键索引。")]),s._v(" "),a("li",[a("strong",[s._v("使用 "),a("code",[s._v("EXPLAIN")]),s._v(" 分析查询")]),s._v("：查看查询的执行计划，找出是否存在全表扫描、索引未使用等问题。")]),s._v(" "),a("li",[a("strong",[s._v("修复常见索引问题")]),s._v("：添加必要的索引、删除冗余索引、优化复合索引的顺序等。")]),s._v(" "),a("li",[a("strong",[s._v("利用 "),a("code",[s._v("ANALYZE TABLE")]),s._v(" 和 "),a("code",[s._v("OPTIMIZE TABLE")])]),s._v("：定期更新表和索引的统计信息，并清理索引碎片。")]),s._v(" "),a("li",[a("strong",[s._v("强制使用索引")]),s._v("：使用优化器提示测试不同的索引选择。")]),s._v(" "),a("li",[a("strong",[s._v("定期监控")])])]),s._v(" "),a("p",[s._v("：通过 "),a("code",[s._v("performance_schema")]),s._v(" 和监控工具定期查看索引的使用情况，优化查询性能。")]),s._v(" "),a("p",[s._v("通过这些步骤，你可以有效排查并优化 MySQL 8 中的索引问题，从而提高数据库的查询性能。")])])}),[],!1,null,null,null);a.default=e.exports}}]);