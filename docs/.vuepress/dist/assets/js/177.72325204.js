(window.webpackJsonp=window.webpackJsonp||[]).push([[177],{608:function(_,v,t){"use strict";t.r(v);var d=t(2),r=Object(d.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"性能分析调优"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#性能分析调优"}},[_._v("#")]),_._v(" 性能分析调优")]),_._v(" "),v("h2",{attrs:{id:"_00-总论"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_00-总论"}},[_._v("#")]),_._v(" 00_总论")]),_._v(" "),v("h3",{attrs:{id:"性能调优的常规手段"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#性能调优的常规手段"}},[_._v("#")]),_._v(" 性能调优的常规手段")]),_._v(" "),v("ol",[v("li",[_._v("空间换时间")]),_._v(" "),v("li",[_._v("时间换空间")]),_._v(" "),v("li",[_._v("分而治之")]),_._v(" "),v("li",[_._v("异步处理")]),_._v(" "),v("li",[_._v("并行")]),_._v(" "),v("li",[_._v("离用户更近一点")]),_._v(" "),v("li",[_._v("一切可拓展,业务模块化,服务化,良好的水平扩展能力")])]),_._v(" "),v("h2",{attrs:{id:"_01-性能分析方法"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_01-性能分析方法"}},[_._v("#")]),_._v(" 01_性能分析方法")]),_._v(" "),v("h3",{attrs:{id:"可以抽象为两大类"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#可以抽象为两大类"}},[_._v("#")]),_._v(" 可以抽象为两大类")]),_._v(" "),v("ol",[v("li",[_._v("自底向上: 通过监控硬件即操作系统性能指标来分析性能问题")]),_._v(" "),v("li",[_._v("自顶向下: 通过生成负载来观察被测试的系统性能")])]),_._v(" "),v("h2",{attrs:{id:"_02-单机性能分析与调优"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_02-单机性能分析与调优"}},[_._v("#")]),_._v(" 02_单机性能分析与调优")]),_._v(" "),v("h3",{attrs:{id:"_021-性能分析流程"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_021-性能分析流程"}},[_._v("#")]),_._v(" 021_性能分析流程")]),_._v(" "),v("p",[v("strong",[_._v("需要关注的指标")])]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("层级")]),_._v(" "),v("th",[_._v("被观测对象")]),_._v(" "),v("th",[_._v("观测指标")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("负载机器")]),_._v(" "),v("td",[_._v("RT(响应时间)")]),_._v(" "),v("td",[_._v("不同业务的响应时间")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("统一业务在不同时间点的响应时间")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("不同配置下的响应时间")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("TPS(每秒完成的事务数)")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("系统资源")]),_._v(" "),v("td",[_._v("CPU")]),_._v(" "),v("td",[_._v("CPU利用率,CPU负载")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("Mem")]),_._v(" "),v("td",[_._v("可用物理内存,虚拟内存使用率,缓存使用量")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("Disks")]),_._v(" "),v("td",[_._v("Disk Time, IO等待")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("Network")]),_._v(" "),v("td",[_._v("宽带使用率,任务队列长度")])]),_._v(" "),v("tr",[v("td",[_._v("Web服务器")]),_._v(" "),v("td",[_._v("Tcp Connections(tcp连接数)")]),_._v(" "),v("td",[_._v('可用netstat观察, grafana中查看"Network Netstat"=>"Tcp Connections"')])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("Thread Pool(中间件的线程池)")]),_._v(" "),v("td",[_._v("监控线程状态")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("JVM")]),_._v(" "),v("td",[_._v("GC情况,Heap使用情况,使用jmx_exporter监控后,可使用grafana监控")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("Load Average")]),_._v(" "),v("td",[_._v("CPU负载队列长度")])]),_._v(" "),v("tr",[v("td",[_._v("应用服务器")]),_._v(" "),v("td",[_._v("DB Connections")]),_._v(" "),v("td",[_._v("中间件与数据库之间建立的连接数及连接状态")])]),_._v(" "),v("tr",[v("td",[_._v("数据库")]),_._v(" "),v("td",[_._v("DB Time")]),_._v(" "),v("td",[_._v("消耗在数据库上的CPU时间")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("Top SQL")]),_._v(" "),v("td",[_._v("按内存由多到少排序SQL,按CPU从多到少排序SQL")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("PGA, SGA")]),_._v(" "),v("td",[_._v("其内存使用情况")])])])]),_._v(" "),v("p",[v("strong",[_._v("性能分析流程")])]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("序号")]),_._v(" "),v("th",[_._v("步骤名称")]),_._v(" "),v("th",[_._v("说明")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("1")]),_._v(" "),v("td",[_._v("检查RT")]),_._v(" "),v("td",[_._v("模拟用户发起负载后,采用自顶向下的方式是偶先分析RT(响应时间)")])]),_._v(" "),v("tr",[v("td",[_._v("2")]),_._v(" "),v("td",[_._v("检查TPS")]),_._v(" "),v("td",[_._v("TPS大时RT小,说明性能良好")])]),_._v(" "),v("tr",[v("td",[_._v("3")]),_._v(" "),v("td",[_._v("检查负载机资源消耗")]),_._v(" "),v("td",[_._v("检查CPU使用率,CPU负载,确认是用户CPU高,还是系统CPU高")])]),_._v(" "),v("tr",[v("td",[_._v("4")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("前提: 确认测试脚本没有性能问题,不会造成统计结果的不准确")])]),_._v(" "),v("tr",[v("td",[_._v("5")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查内存使用情况,确认内存泄露风险,不会造成结果统计的不准确")])]),_._v(" "),v("tr",[v("td",[_._v("6")]),_._v(" "),v("td",[_._v("判断负载机是否有性能问题")]),_._v(" "),v("td",[_._v("排除负载机的问题,确保测试结果可参考")])]),_._v(" "),v("tr",[v("td",[_._v("7")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("Tips: 负载机的CPU不过高,内存不过高,并且负载机和被测对象的带宽是否足够,比如局域网下测试")])]),_._v(" "),v("tr",[v("td",[_._v("8")]),_._v(" "),v("td",[_._v("检查WEb服务器的资源消耗")]),_._v(" "),v("td",[_._v("检查CPU使用率,确认用户CPU与系统CPU占用情况")])]),_._v(" "),v("tr",[v("td",[_._v("9")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查内存使用请看")])]),_._v(" "),v("tr",[v("td",[_._v("10")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查磁盘使用情况")])]),_._v(" "),v("tr",[v("td",[_._v("11")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查占用的带宽")])]),_._v(" "),v("tr",[v("td",[_._v("12")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("分析Web页面响应的时间组成,确认是什么影响了性能")])]),_._v(" "),v("tr",[v("td",[_._v("13")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("Tips: Litemall单机环境系统CPU使用在10%以下")])]),_._v(" "),v("tr",[v("td",[_._v("14")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("Tips: Litemall单机环境(4U8G),CPU在75%时候,需要50M带宽")])]),_._v(" "),v("tr",[v("td",[_._v("15")]),_._v(" "),v("td",[_._v("检查是否Web服务器瓶颈")]),_._v(" "),v("td",[_._v("判断是否web服务器硬件性能瓶颈")])]),_._v(" "),v("tr",[v("td",[_._v("16")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("Tips: 瓶颈总会到达的,主要看,有没有那个指标增长变化的太快,比预期中提前到达瓶颈")])]),_._v(" "),v("tr",[v("td",[_._v("17")]),_._v(" "),v("td",[_._v("检查中间件配置")]),_._v(" "),v("td",[_._v("确认是否是此配置问题")])]),_._v(" "),v("tr",[v("td",[_._v("18")]),_._v(" "),v("td",[_._v("检查App服务器资源消耗")]),_._v(" "),v("td",[_._v("关注CPU,内存,磁盘,IO,判断是否是App服务器硬件性能瓶颈")])]),_._v(" "),v("tr",[v("td",[_._v("19")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("Tips: 有时候web服务器和引用服务器会分离部署")])]),_._v(" "),v("tr",[v("td",[_._v("20")]),_._v(" "),v("td",[_._v("数据库服务器资源消耗分析")]),_._v(" "),v("td",[_._v("CPU消耗,CPU负载")])]),_._v(" "),v("tr",[v("td",[_._v("21")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("内存消耗")])]),_._v(" "),v("tr",[v("td",[_._v("22")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("IO繁忙程度")])]),_._v(" "),v("tr",[v("td",[_._v("23")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("数据库监控")])]),_._v(" "),v("tr",[v("td",[_._v("24")]),_._v(" "),v("td",[_._v("是否是DB的性能问题")]),_._v(" "),v("td",[_._v("由监控结果来判断是否是DB性能问题")])]),_._v(" "),v("tr",[v("td",[_._v("25")]),_._v(" "),v("td",[_._v("是否SQL问题")]),_._v(" "),v("td",[_._v("定位最不合理的SQL占比")])]),_._v(" "),v("tr",[v("td",[_._v("26")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("索引是否正常引用")])]),_._v(" "),v("tr",[v("td",[_._v("27")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查共享SQL是否合理范围")])]),_._v(" "),v("tr",[v("td",[_._v("28")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查解析ER结构是否合理")])]),_._v(" "),v("tr",[v("td",[_._v("29")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查数据热点问题")])]),_._v(" "),v("tr",[v("td",[_._v("30")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查数据分布是否合理")])]),_._v(" "),v("tr",[v("td",[_._v("31")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("检查碎片整理等等")])]),_._v(" "),v("tr",[v("td",[_._v("32")]),_._v(" "),v("td",[_._v("其他")]),_._v(" "),v("td",[_._v("比如网络阻塞,磁盘IO瓶颈,热点等等")])])])]),_._v(" "),v("h4",{attrs:{id:"主要涉及的知识"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#主要涉及的知识"}},[_._v("#")]),_._v(" 主要涉及的知识")]),_._v(" "),v("ol",[v("li",[_._v("硬件知识(CPU, MEM, Disk, Net)")]),_._v(" "),v("li",[_._v("系统知识(Linux,Windows)")]),_._v(" "),v("li",[_._v("中间件知识(JVM, Tomcat, Jboss, Weblogic, WebSphere等)")]),_._v(" "),v("li",[_._v("数据库知识(Mysql, SQLserver, Oracle, DB2, Sysbase)")]),_._v(" "),v("li",[_._v("网络知识(截包分析)")]),_._v(" "),v("li",[_._v("程序知识")]),_._v(" "),v("li",[_._v("架构知识")])]),_._v(" "),v("h3",{attrs:{id:"_022-系统性能关注点"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_022-系统性能关注点"}},[_._v("#")]),_._v(" 022_系统性能关注点")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("序号")]),_._v(" "),v("th",[_._v("关注点")]),_._v(" "),v("th",[_._v("具体")]),_._v(" "),v("th",[_._v("原因分析")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("1")]),_._v(" "),v("td",[_._v("System Resource(系统资源)")]),_._v(" "),v("td",[_._v("CPU利用率过高")]),_._v(" "),v("td",[_._v("计算量大 (运算,连接查询, 数据统计)")])]),_._v(" "),v("tr",[v("td",[_._v("2")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("非空闲等待 (IO等待,资源争用)")])]),_._v(" "),v("tr",[v("td",[_._v("3")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("过多的系统调用 (比如频繁写日志)")])]),_._v(" "),v("tr",[v("td",[_._v("4")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("过多的中断 (外部设备中断等)")])]),_._v(" "),v("tr",[v("td",[_._v("5")]),_._v(" "),v("td",[_._v("内存吃紧")]),_._v(" "),v("td",[_._v("过多的页交换和内存泄露")]),_._v(" "),v("td",[_._v("JVM内存设置过小")])]),_._v(" "),v("tr",[v("td",[_._v("6")]),_._v(" "),v("td",[_._v("磁盘繁忙")]),_._v(" "),v("td",[_._v("硬盘IO速度低(极少情况)")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("7")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("硬盘老化,或者碎片过多等")]),_._v(" "),v("td",[_._v("较难优化,只能在设计的时候考虑")])]),_._v(" "),v("tr",[v("td",[_._v("8")]),_._v(" "),v("td",[_._v("网络流量过大")]),_._v(" "),v("td",[_._v("高并发系统")]),_._v(" "),v("td",[_._v("并发用户多,")])]),_._v(" "),v("tr",[v("td",[_._v("9")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("所处环境宽小")]),_._v(" "),v("td",[_._v("非局域网情况下,或者环境在公有云上等")])]),_._v(" "),v("tr",[v("td",[_._v("10")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("带宽被抢占")]),_._v(" "),v("td",[_._v("该环境写有网络控制策略等")])]),_._v(" "),v("tr",[v("td",[_._v("11")]),_._v(" "),v("td",[_._v("OS(操作系统)")]),_._v(" "),v("td",[_._v("系统负载")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("12")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("系统连接数的控制")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("13")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("缓存")]),_._v(" "),v("td",[_._v("内存不够时还会有虚拟内存机制")])]),_._v(" "),v("tr",[v("td",[_._v("14")]),_._v(" "),v("td",[_._v("DB(数据库)")]),_._v(" "),v("td",[_._v("OLTP(联机事务处理系统)")]),_._v(" "),v("td",[_._v("慢查询")])]),_._v(" "),v("tr",[v("td",[_._v("15")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("大事务")])]),_._v(" "),v("tr",[v("td",[_._v("16")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("死锁")])]),_._v(" "),v("tr",[v("td",[_._v("17")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("DB Time")])]),_._v(" "),v("tr",[v("td",[_._v("18")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("磁盘IO等待时间")])]),_._v(" "),v("tr",[v("td",[_._v("19")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("处理方法1:优化业务过程,尽量减少数据请求,不管读写")])]),_._v(" "),v("tr",[v("td",[_._v("20")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("处理方法2: 优化SQL语句提高效率")])]),_._v(" "),v("tr",[v("td",[_._v("21")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("OLAP(联机分析处理)")]),_._v(" "),v("td",[_._v("处理方法1: 预处理, 比如物理化, 多维数据")])]),_._v(" "),v("tr",[v("td",[_._v("22")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("处理方法2: 分而治之,比如并行查询")])]),_._v(" "),v("tr",[v("td",[_._v("23")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("处理方法3: 优化语句提高效率")])]),_._v(" "),v("tr",[v("td",[_._v("24")]),_._v(" "),v("td",[_._v("Middleware(中间件)")]),_._v(" "),v("td",[_._v("JVM")]),_._v(" "),v("td",[_._v("JVM对内存使用情况,GC频率,线程状态")])]),_._v(" "),v("tr",[v("td",[_._v("25")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("Thread pool")]),_._v(" "),v("td",[_._v("需要监控,如果使用率达到阈值则需要增加线程池容量")])]),_._v(" "),v("tr",[v("td",[_._v("26")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("DB Connections Pool")]),_._v(" "),v("td",[_._v("需要监控,如果使用率达到阈值则需要增加容量")])]),_._v(" "),v("tr",[v("td",[_._v("27")]),_._v(" "),v("td",[_._v("Appserver")]),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("28")]),_._v(" "),v("td",[_._v("Webserver")]),_._v(" "),v("td",[_._v("页面size")]),_._v(" "),v("td",[_._v("动态数据, CSS, JS, 图片等的大小")])]),_._v(" "),v("tr",[v("td",[_._v("29")]),_._v(" "),v("td"),_._v(" "),v("td",[_._v("隐藏的,无用的数据传输")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("30")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("优化方法1: 页面静态化")])]),_._v(" "),v("tr",[v("td",[_._v("31")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("优化方法2: 减小页面Size,图片更小,CSS合并,JS精简,")])]),_._v(" "),v("tr",[v("td",[_._v("32")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("优化方法3: 砍掉无用请求,无用数据传输,")])]),_._v(" "),v("tr",[v("td",[_._v("33")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("优化方法4: 对数据做异步处理")])]),_._v(" "),v("tr",[v("td",[_._v("34")]),_._v(" "),v("td"),_._v(" "),v("td"),_._v(" "),v("td",[_._v("优化方法5: DNS和CDN加速,让响应数据离用户更近")])])])]),_._v(" "),v("h3",{attrs:{id:"_023-程序优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_023-程序优化"}},[_._v("#")]),_._v(" 023_程序优化")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("策略")]),_._v(" "),v("th",[_._v("方向")]),_._v(" "),v("th",[_._v("具体")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("系统框架选择")]),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("程序优化")]),_._v(" "),v("td",[_._v("表单压缩")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("局部刷新")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("仅取所需")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("逻辑亲戚")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("谨慎继承")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("程序算法优化")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("批处理")]),_._v(" "),v("td",[_._v("对于大批量的数据,最好能够醉成批处理,不会因为单次操作而影响系统的正常操作"),v("br"),_._v("比如对数据的传输,通过打包定时的方式去传输")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("延迟处理")]),_._v(" "),v("td",[_._v("对于大对象的展示采用延迟加载的方式,层层递进的显示 明细")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("防止内存泄露")]),_._v(" "),v("td",[_._v("对于生命周期长的对象风险较大, 引入的第三方软件也需要单独测试,session需要做过期处理")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("减少大对象引用")]),_._v(" "),v("td",[_._v("需要控制大对象的使用,避免资源浪费")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("防止争用死锁")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("索引")]),_._v(" "),v("td",[_._v("编写合理的SQL,尽量使用索引")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("存储过程")]),_._v(" "),v("td",[_._v("分布式数据库不推荐使用,存储过程即在存储过程中就尽量做一部分运算")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("内存分配")]),_._v(" "),v("td",[_._v("合理分配PGA和SGA(oracle数据库)")])]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("并行")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("异步")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("使用好的设计模式来优化程序")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("选择合适的IO模式")]),_._v(" "),v("td",[_._v("比如NIO, AIO等")])])])]),_._v(" "),v("h3",{attrs:{id:"_024-配置优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_024-配置优化"}},[_._v("#")]),_._v(" 024_配置优化")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("策略")]),_._v(" "),v("th",[_._v("方向")]),_._v(" "),v("th",[_._v("具体")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("连接池的配置参数")]),_._v(" "),v("td",[_._v("Spring+Hibernate+C3P0来配置")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("连接池配置多少连接合适")]),_._v(" "),v("td",[_._v("没有精确的计算公式,通过测试来估算,再根据实际业务增长来进行放大")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("监控连接池")]),_._v(" "),v("td",[_._v("数据库连接池监控,可以用prometheus+grafana技术栈来监控")]),_._v(" "),v("td")])])]),_._v(" "),v("h3",{attrs:{id:"_026-线程优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_026-线程优化"}},[_._v("#")]),_._v(" 026_线程优化")]),_._v(" "),v("table",[v("thead",[v("tr",[v("th",[_._v("策略")]),_._v(" "),v("th",[_._v("方向")]),_._v(" "),v("th",[_._v("具体")])])]),_._v(" "),v("tbody",[v("tr",[v("td",[_._v("线程池优化")]),_._v(" "),v("td",[_._v("增加线程池")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("CPU处理能力")]),_._v(" "),v("td",[_._v("综合分析CPU的处理能力,再去配置")]),_._v(" "),v("td",[_._v("比如CPU一个核心每秒能够处理10个任务,name一个核心的CPU每秒理论上能处理40个任务,"),v("br"),_._v("在同一时刻CPU最多只能处理4个任务,所以理论上线程池配置4个连接"),v("br"),_._v("但实际上,服务器的追加线程数量=((线程等待时间+线程CPU时间)/线程CPU时间) * CPU数量")])]),_._v(" "),v("tr",[v("td",[_._v("内存容量")]),_._v(" "),v("td",[_._v("JVM内存")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("系统线程数限制")]),_._v(" "),v("td"),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td",[_._v("DB优化")]),_._v(" "),v("td",[_._v("优化物理结构")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("共享SQL,绑定变量,降低高水位")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("查询器优化")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("单条SQL优化")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("并行SQL")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("减少资源争用")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("优化内存")]),_._v(" "),v("td")]),_._v(" "),v("tr",[v("td"),_._v(" "),v("td",[_._v("优化IO")]),_._v(" "),v("td",[_._v("进行条带化,读写分离,减少热点")])])])]),_._v(" "),v("h2",{attrs:{id:"_03-业务流程优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_03-业务流程优化"}},[_._v("#")]),_._v(" 03_业务流程优化")]),_._v(" "),v("p",[_._v("不建议,因为风险较大,一般在设计开发阶段去考虑")]),_._v(" "),v("h2",{attrs:{id:"_04-结构优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_04-结构优化"}},[_._v("#")]),_._v(" 04_结构优化")]),_._v(" "),v("h3",{attrs:{id:"_041-单机结构"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_041-单机结构"}},[_._v("#")]),_._v(" 041_单机结构")]),_._v(" "),v("h3",{attrs:{id:"_042-集群结构"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_042-集群结构"}},[_._v("#")]),_._v(" 042_集群结构")]),_._v(" "),v("h3",{attrs:{id:"_043-分布式结构"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#_043-分布式结构"}},[_._v("#")]),_._v(" 043_分布式结构")]),_._v(" "),v("ol",[v("li",[_._v("DNS&CDN静态加速")]),_._v(" "),v("li",[_._v("负载均衡器")]),_._v(" "),v("li",[_._v("Web服务分布式集群")]),_._v(" "),v("li",[_._v("App服务分布式集群")]),_._v(" "),v("li",[_._v("分布式缓存")]),_._v(" "),v("li",[_._v("分布式数据库")])])])}),[],!1,null,null,null);v.default=r.exports}}]);