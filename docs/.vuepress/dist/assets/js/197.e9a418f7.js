(window.webpackJsonp=window.webpackJsonp||[]).push([[197],{628:function(s,t,a){"use strict";a.r(t);var v=a(2),_=Object(v.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("code",[s._v("vmstat")]),s._v(" 是 Linux 系统中的一个强大的性能监控工具，用于显示虚拟内存、CPU 使用率、系统进程、I/O 等多项系统资源的统计数据。它可以帮助你快速排查系统性能瓶颈，如 CPU 过载、内存不足、I/O 瓶颈等。")]),s._v(" "),t("h3",{attrs:{id:"_1-安装-vmstat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-安装-vmstat"}},[s._v("#")]),s._v(" 1. "),t("strong",[s._v("安装 "),t("code",[s._v("vmstat")])])]),s._v(" "),t("p",[s._v("通常，"),t("code",[s._v("vmstat")]),s._v(" 是 "),t("code",[s._v("procps")]),s._v(" 包的一部分，默认会随大多数 Linux 发行版一起安装。如果系统中没有安装，可以通过以下命令安装：")]),s._v(" "),t("h4",{attrs:{id:"centos-rhel"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos-rhel"}},[s._v("#")]),s._v(" CentOS / RHEL:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" procps\n")])])]),t("h4",{attrs:{id:"ubuntu-debian"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ubuntu-debian"}},[s._v("#")]),s._v(" Ubuntu / Debian:")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" procps\n")])])]),t("h3",{attrs:{id:"_2-基本使用方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-基本使用方法"}},[s._v("#")]),s._v(" 2. "),t("strong",[s._v("基本使用方法")])]),s._v(" "),t("p",[s._v("运行 "),t("code",[s._v("vmstat")]),s._v(" 命令可以显示系统的 CPU、内存、I/O、进程等信息。命令格式如下：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vmstat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("刷新间隔"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("刷新次数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("ul",[t("li",[t("strong",[s._v("刷新间隔")]),s._v("：数据刷新间隔的秒数，默认为一次性输出。")]),s._v(" "),t("li",[t("strong",[s._v("刷新次数")]),s._v("：数据刷新的次数。")])]),s._v(" "),t("h4",{attrs:{id:"示例-1-一次性查看系统状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例-1-一次性查看系统状态"}},[s._v("#")]),s._v(" 示例 1：一次性查看系统状态")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vmstat")]),s._v("\n")])])]),t("h4",{attrs:{id:"示例-2-每-2-秒刷新一次-共显示-5-次"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例-2-每-2-秒刷新一次-共显示-5-次"}},[s._v("#")]),s._v(" 示例 2：每 2 秒刷新一次，共显示 5 次")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vmstat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("\n")])])]),t("h3",{attrs:{id:"_3-vmstat-输出解读"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-vmstat-输出解读"}},[s._v("#")]),s._v(" 3. "),t("strong",[t("code",[s._v("vmstat")]),s._v(" 输出解读")])]),s._v(" "),t("p",[t("code",[s._v("vmstat")]),s._v(" 的输出包含多列信息，涵盖了进程、内存、交换空间、I/O 操作、系统中断和 CPU 使用率等。下面是各个字段的详细解读。")]),s._v(" "),t("h4",{attrs:{id:"vmstat-输出示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#vmstat-输出示例"}},[s._v("#")]),s._v(" "),t("code",[s._v("vmstat")]),s._v(" 输出示例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("procs -----------memory---------- ---swap-- -----io---- -system-- ----cpu----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 1  0      0  30000  15000  200000   0    0     2     5   40   10  5  2 90  3  0\n")])])]),t("h4",{attrs:{id:"_3-1-procs-列-进程信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-procs-列-进程信息"}},[s._v("#")]),s._v(" 3.1 "),t("strong",[t("code",[s._v("procs")]),s._v(" 列（进程信息）")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("r")]),s._v("：运行队列中的进程数量（等待 CPU 的进程数）。如果这个值大于系统的 CPU 核心数，说明 CPU 可能成为瓶颈，任务等待 CPU 资源。")]),s._v(" "),t("li",[t("strong",[s._v("b")]),s._v("：不可中断睡眠状态的进程数，通常是等待 I/O 操作完成的进程。值较大时可能表示系统存在 I/O 瓶颈。")])]),s._v(" "),t("h4",{attrs:{id:"示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[s._v("#")]),s._v(" 示例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("r = 1：有 1 个进程在等待 CPU。\nb = 0：没有进程在等待 I/O。\n")])])]),t("h4",{attrs:{id:"_3-2-memory-列-内存信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-memory-列-内存信息"}},[s._v("#")]),s._v(" 3.2 "),t("strong",[t("code",[s._v("memory")]),s._v(" 列（内存信息）")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("swpd")]),s._v("：已使用的交换空间大小（以 KB 为单位）。如果这个值不为 0，说明系统已经在使用交换空间，可能是内存不足的表现。")]),s._v(" "),t("li",[t("strong",[s._v("free")]),s._v("：空闲的物理内存大小（以 KB 为单位）。")]),s._v(" "),t("li",[t("strong",[s._v("buff")]),s._v("：用于块设备的缓冲区大小（以 KB 为单位），通常用于临时存储磁盘块的数据。")]),s._v(" "),t("li",[t("strong",[s._v("cache")]),s._v("：用于文件系统缓存的内存大小（以 KB 为单位），表示系统为提高文件 I/O 性能而保留在内存中的文件数据。")])]),s._v(" "),t("h4",{attrs:{id:"示例-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例-2"}},[s._v("#")]),s._v(" 示例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("swpd = 0：没有使用交换空间。\nfree = 30000：系统有 30 MB 的空闲内存。\n")])])]),t("h4",{attrs:{id:"_3-3-swap-列-交换空间信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-swap-列-交换空间信息"}},[s._v("#")]),s._v(" 3.3 "),t("strong",[t("code",[s._v("swap")]),s._v(" 列（交换空间信息）")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("si")]),s._v("：从交换空间中交换到内存的大小（每秒，单位 KB）。如果这个值大于 0，说明系统需要从交换空间中恢复数据，表示内存可能不足。")]),s._v(" "),t("li",[t("strong",[s._v("so")]),s._v("：从内存交换到交换空间的大小（每秒，单位 KB）。如果这个值大于 0，说明系统正在将数据从内存中写入交换空间，表示内存压力较大。")])]),s._v(" "),t("h4",{attrs:{id:"示例-3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例-3"}},[s._v("#")]),s._v(" 示例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("si = 0，so = 0：系统没有进行交换操作，内存压力不大。\n")])])]),t("h4",{attrs:{id:"_3-4-io-列-i-o-信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-io-列-i-o-信息"}},[s._v("#")]),s._v(" 3.4 "),t("strong",[t("code",[s._v("io")]),s._v(" 列（I/O 信息）")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("bi")]),s._v("：每秒从块设备（如磁盘）读取的数据块数（单位：块）。如果这个值很大，说明系统正在进行大量的磁盘读操作。")]),s._v(" "),t("li",[t("strong",[s._v("bo")]),s._v("：每秒写入到块设备的数据块数（单位：块）。如果这个值很大，说明系统正在进行大量的磁盘写操作。")])]),s._v(" "),t("h4",{attrs:{id:"示例-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例-4"}},[s._v("#")]),s._v(" 示例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("bi = 2：每秒读取 2 个数据块，I/O 负载较轻。\nbo = 5：每秒写入 5 个数据块，I/O 负载较轻。\n")])])]),t("h4",{attrs:{id:"_3-5-system-列-系统信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-system-列-系统信息"}},[s._v("#")]),s._v(" 3.5 "),t("strong",[t("code",[s._v("system")]),s._v(" 列（系统信息）")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("in")]),s._v("：每秒发生的设备中断次数（中断数），包括硬件和系统时钟中断。如果这个值很大，说明系统处理中断的频率较高。")]),s._v(" "),t("li",[t("strong",[s._v("cs")]),s._v("：每秒发生的上下文切换次数（上下文切换数）。如果这个值很高，表示进程频繁切换，可能是因为系统负载较高。")])]),s._v(" "),t("h4",{attrs:{id:"示例-5"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例-5"}},[s._v("#")]),s._v(" 示例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("in = 40：每秒有 40 次中断，系统负载正常。\ncs = 10：每秒 10 次上下文切换，系统进程切换频率较低。\n")])])]),t("h4",{attrs:{id:"_3-6-cpu-列-cpu-信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-cpu-列-cpu-信息"}},[s._v("#")]),s._v(" 3.6 "),t("strong",[t("code",[s._v("cpu")]),s._v(" 列（CPU 信息）")])]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("us")]),s._v("：用户进程使用的 CPU 时间百分比（非内核进程）。表示 CPU 在运行用户级应用程序的时间占比。")]),s._v(" "),t("li",[t("strong",[s._v("sy")]),s._v("：系统进程使用的 CPU 时间百分比（内核进程）。表示 CPU 在运行系统级任务（如 I/O 操作）的时间占比。")]),s._v(" "),t("li",[t("strong",[s._v("id")]),s._v("：CPU 空闲时间百分比。此值越大，表示系统的 CPU 负载越轻。")]),s._v(" "),t("li",[t("strong",[s._v("wa")]),s._v("：等待 I/O 操作完成的时间百分比。这个值较大表示系统中存在 I/O 瓶颈。")]),s._v(" "),t("li",[t("strong",[s._v("st")]),s._v("：虚拟机管理程序被其他虚拟机抢占的时间百分比。该值通常只在虚拟化环境中存在。")])]),s._v(" "),t("h4",{attrs:{id:"示例-6"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例-6"}},[s._v("#")]),s._v(" 示例：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("us = 5%：CPU 的 5% 时间用于用户级进程。\nsy = 2%：CPU 的 2% 时间用于系统级任务。\nid = 90%：CPU 空闲时间为 90%，说明系统 CPU 负载较轻。\nwa = 3%：CPU 有 3% 的时间在等待 I/O 操作完成。\n")])])]),t("h3",{attrs:{id:"_4-vmstat-使用中的常见瓶颈分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-vmstat-使用中的常见瓶颈分析"}},[s._v("#")]),s._v(" 4. "),t("strong",[t("code",[s._v("vmstat")]),s._v(" 使用中的常见瓶颈分析")])]),s._v(" "),t("h4",{attrs:{id:"_4-1-cpu-瓶颈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-cpu-瓶颈"}},[s._v("#")]),s._v(" 4.1 CPU 瓶颈")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("r")]),s._v(" 列的值大于 CPU 核心数（如 "),t("code",[s._v("r=8")]),s._v(" 在 4 核系统上），且 "),t("strong",[s._v("id")]),s._v(" 值较小（CPU 空闲时间较少），表明 CPU 资源不足，可能需要增加 CPU 核心数或优化程序。")]),s._v(" "),t("li",[t("strong",[s._v("sy")]),s._v(" 和 "),t("strong",[s._v("us")]),s._v(" 的值很高，表明系统在处理大量的系统或用户级进程，可能需要分析高 CPU 消耗的进程。")])]),s._v(" "),t("h4",{attrs:{id:"_4-2-内存瓶颈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-内存瓶颈"}},[s._v("#")]),s._v(" 4.2 内存瓶颈")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("swpd")]),s._v(" 值不为 0，且 "),t("strong",[s._v("si")]),s._v(" 或 "),t("strong",[s._v("so")]),s._v(" 列的值较大时，表明系统的物理内存不足，正在频繁使用交换空间。解决方案是增加物理内存或减少内存消耗大的进程。")]),s._v(" "),t("li",[t("strong",[s._v("free")]),s._v(" 值很低，且 "),t("strong",[s._v("buff")]),s._v(" 和 "),t("strong",[s._v("cache")]),s._v(" 值较大，表明系统内存用于缓存和缓冲区。虽然 "),t("strong",[s._v("buff")]),s._v(" 和 "),t("strong",[s._v("cache")]),s._v(" 的使用属于良性使用，但过高可能表明内存压力较大。")])]),s._v(" "),t("h4",{attrs:{id:"_4-3-i-o-瓶颈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-i-o-瓶颈"}},[s._v("#")]),s._v(" 4.3 I/O 瓶颈")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("wa")]),s._v(" 值较高，表明系统中大量进程在等待 I/O 操作完成，可能的原因是磁盘 I/O 性能不足。")]),s._v(" "),t("li",[t("strong",[s._v("bi")]),s._v(" 和 "),t("strong",[s._v("bo")]),s._v(" 值很大，表示系统正在进行大量的磁盘读写操作，I/O 负载较重。可能需要升级存储设备（如使用 SSD）或优化磁盘 I/O 相关的应用程序。")])]),s._v(" "),t("h4",{attrs:{id:"_4-4-进程瓶颈"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-进程瓶颈"}},[s._v("#")]),s._v(" 4.4 进程瓶颈")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("r")]),s._v(" 值远大于 CPU 核心数，表示大量进程在等待 CPU 资源。")]),s._v(" "),t("li",[t("strong",[s._v("cs")]),s._v(" 值较高，表示系统频繁发生上下文切换，可能是因为系统负载较高或者锁争用严重。")])]),s._v(" "),t("h3",{attrs:{id:"_5-常见使用场景"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-常见使用场景"}},[s._v("#")]),s._v(" 5. "),t("strong",[s._v("常见使用场景")])]),s._v(" "),t("ul",[t("li",[t("p",[t("strong",[s._v("检查 CPU 和内存使用情况")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vmstat")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 每隔2秒刷新一次，共刷新5次")]),s._v("\n")])])]),t("p",[s._v("可以监控 CPU 的使用情况，查看是否存在 CPU 过载的情况。")])]),s._v(" "),t("li",[t("p",[t("strong",[s._v("分析 I/O 瓶颈")]),s._v("：\n如果发现 "),t("strong",[s._v("wa")]),s._v(" 值较高，可以通过 "),t("strong",[s._v("bi")]),s._v(" 和 "),t("strong",[s._v("bo")]),s._v(" 列来进一步")])])]),s._v(" "),t("p",[s._v("判断 I/O 的读写情况。")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("诊断内存不足")]),s._v("：\n如果系统频繁使用交换空间（"),t("strong",[s._v("si")]),s._v(" 和 "),t("strong",[s._v("so")]),s._v(" 列大于 0），说明物理内存不足，可能需要扩展内存。")])]),s._v(" "),t("h3",{attrs:{id:"总结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[s._v("#")]),s._v(" 总结")]),s._v(" "),t("p",[t("code",[s._v("vmstat")]),s._v(" 是一个非常有用的工具，用来监控系统性能，特别是在 CPU、内存和 I/O 方面。通过对各列的指标进行解读，可以快速发现系统的瓶颈问题，如 CPU 过载、内存不足或磁盘 I/O 性能瓶颈，从而帮助你进行系统性能优化。")])])}),[],!1,null,null,null);t.default=_.exports}}]);