以下是针对**移动应用安全测试**的全面测试点梳理与补充，涵盖数据安全、传输加密、代码防护等关键领域，并结合OWASP Mobile Top 10风险进行扩展：

---

### **1. 数据存储安全测试**
#### **1.1 敏感数据泄露**
- **测试点**：
  - **本地存储检测**：  
    - 检查`SharedPreferences`、`SQLite`、`Realm`等存储中是否明文保存用户密码、令牌（如`access_token`）。  
    - 验证`AndroidManifest.xml`中是否设置`android:allowBackup="false"`（防止备份数据泄露）。  
  - **日志泄露**：  
    - 运行应用时通过`logcat`检查是否打印敏感信息（如身份证号、银行卡号）。  

#### **1.2 加密与清理机制**
- **测试用例**：
  - **密钥管理**：  
    - 测试硬编码密钥（如AES密钥）是否被混淆（使用`jadx`反编译APK验证）。  
    - 验证是否使用Android Keystore/iOS Keychain管理密钥。  
  - **临时文件清理**：  
    - 测试应用崩溃后，`/tmp`目录下的缓存图片或文档是否自动删除。  

---

### **2. 数据传输安全测试**
#### **2.1 通信加密**
- **测试点**：
  - **HTTPS合规性**：  
    - 使用Burp Suite拦截请求，验证是否允许TLS 1.0/1.1（应强制TLS 1.2+）。  
    - 检查证书链是否完整（防止中间人攻击）。  
  - **敏感接口暴露**：  
    - 测试未授权的API端点（如`/api/user/list`）是否返回403而非200。  

#### **2.2 数据篡改与重放**
- **测试用例**：
  - **请求签名**：  
    - 修改请求参数（如`amount=100`→`amount=10000`）测试服务端是否验证签名。  
  - **时间戳防重放**：  
    - 重复发送同一请求（如OTP验证），检查服务端是否拒绝5分钟前的请求。  

---

### **3. 代码与运行时安全测试**
#### **3.1 注入攻击防护**
- **测试点**：
  - **SQL注入**：  
    - 在输入框输入`' OR 1=1 --`，测试本地数据库查询是否参数化（如Android的`SQLiteStatement`）。  
  - **WebView漏洞**：  
    - 测试`setJavaScriptEnabled(true)`时，是否禁用`addJavascriptInterface`（防止XSS攻击）。  

#### **3.2 反逆向工程**
- **测试用例**：
  - **代码混淆**：  
    - 使用Apktool反编译APK，验证核心逻辑是否被ProGuard/R8混淆（如类名变为`a.b.c`）。  
  - **Root/越狱检测**：  
    - 在Magisk隐藏Root的设备上，测试银行类应用是否仍能检测到Root环境。  

---

### **4. 认证与会话安全测试**
#### **4.1 身份验证漏洞**
- **测试点**：
  - **弱密码策略**：  
    - 测试是否允许`123456`作为密码，或未强制要求特殊字符。  
  - **生物识别绕过**：  
    - 在Android设备上使用`adb shell`模拟指纹输入，测试是否仅依赖`FingerprintManager`结果。  

#### **4.2 会话管理**
- **测试用例**：
  - **Token有效期**：  
    - 获取有效Token后，测试24小时后是否强制重新登录。  
  - **多设备登录**：  
    - 同一账号在手机和平板同时登录时，是否提示“账号异地登录”。  

---

### **5. 权限与隐私测试**
#### **5.1 权限滥用**
- **测试点**：
  - **过度权限申请**：  
    - 检查计算器应用是否请求通讯录权限（与功能无关的权限应拒绝）。  
  - **后台权限窃取**：  
    - 测试应用退到后台时，是否持续访问GPS或麦克风（需触发`onPause`释放资源）。  

#### **5.2 隐私合规**
- **测试用例**：  
  - **GDPR/CCPA合规**：  
    - 测试首次启动时是否弹出隐私协议弹窗，且“拒绝”选项与“同意”同等醒目。  
  - **数据收集声明**：  
    - 检查隐私政策是否明确列出第三方SDK（如Firebase、Facebook SDK）的数据共享范围。  

---

### **6. 物理与侧信道攻击测试**
#### **6.1 屏幕缓存泄露**
- **测试用例**：  
  - 测试应用进入后台时，是否禁用屏幕截图（Android的`FLAG_SECURE`）。  
  - 在最近任务视图中，检查敏感页面（如支付页）是否显示模糊预览图。  

#### **6.2 侧信道攻击**
- **测试点**：  
  - **键盘输入推断**：  
    - 通过高速摄像录制屏幕，分析输入密码时按键区域的触控反馈差异。  
  - **功耗分析**：  
    - 使用专业设备监测加密操作时的功耗波动（推测密钥位）。  

---

### **7. 工具与自动化策略**
#### **7.1 推荐工具**
| **测试类型** | **工具**               | **使用场景**                    |
| ------------ | ---------------------- | ------------------------------- |
| 动态分析     | Frida、Objection       | 实时Hook检测加密逻辑            |
| 静态分析     | MobSF、QARK            | 扫描APK/IPA中的硬编码密钥       |
| 流量拦截     | Burp Suite、Charles    | 测试HTTPS证书校验与数据明文传输 |
| 设备模拟     | Genymotion（Root模式） | 测试Root环境下的防护机制        |

#### **7.2 自动化建议**
- **CI/CD集成**：  
  - 在构建流程中加入MobSF扫描，阻断存在`android:debuggable="true"`的版本发布。  
- **合规检查**：  
  - 使用App Privacy Insights工具自动检测第三方SDK隐私数据收集行为。  

---

### **8. 扩展测试场景（OWASP Mobile Top 10）**
1. **M1: 不当平台使用**  
   - 测试`WebView`是否允许`file://`协议加载本地HTML（可能导致XSS）。  
2. **M4: 不安全通信**  
   - 验证是否禁用HTTP明文传输（Android 9+强制Cleartext Traffic限制）。  
3. **M7: 客户端代码质量**  
   - 测试反编译后的代码是否暴露加密算法（如AES ECB模式）。  

---

通过以上测试点，可系统性覆盖移动应用的安全风险。**优先级建议**：  
1. **高危必测**：HTTPS中间人攻击、敏感数据明文存储、Root环境绕过。  
2. **合规重点**：隐私政策一致性、权限最小化原则。  
3. **深度防护**：反编译保护、侧信道攻击防护（金融类应用必备）。